# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è **finance_recommendations**, –∏—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∏ –∞–ª–≥–æ—Ä–∏—Ç–º —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.

## üìò –û–±–∑–æ—Ä
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∞–≤–∏–ª.
–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —Å–∏—Å—Ç–µ–º–æ–π –≤–æ–∑–º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ REST API –∏ Telegram-–±–æ—Ç–∞.
–î–∞–Ω–Ω—ã–µ –±–µ—Ä—É—Ç—Å—è –∏–∑ –¥–≤—É—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤: **rules-db** (–æ—Å–Ω–æ–≤–Ω–∞—è) –∏ **reco-db** (read-only).

## üß© –î–∏–∞–≥—Ä–∞–º–º–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
```mermaid
flowchart LR
    U[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å]:::actor
    M[–ú–µ–Ω–µ–¥–∂–µ—Ä]:::actor
    X[–í–Ω–µ—à–Ω—è—è —Å–∏—Å—Ç–µ–º–∞]:::actor
    API[REST API]:::entry
    TG[Telegram Bot]:::entry
    U -->|HTTP /api/...| API
    U -->|/recommend –ò–º—è –§–∞–º–∏–ª–∏—è| TG
    M -->|/rule CRUD| API
    X -->|/management/clear-caches| API
    subgraph Service
      RSVC[RecommendationsServiceImpl]:::service
      RULESVC[RuleService]:::service
      STAT[RuleStatService]:::service
      EVAL[DynamicRuleEvaluator]:::service
    end
    API --> RSVC
    TG --> RSVC
    RSVC --> RULESVC
    RSVC --> STAT
    RSVC --> EVAL
    subgraph Repo
      RECORepo[RecommendationsRepository]:::repo
      DRRepo[DynamicRuleRepository]:::repo
      DRStatRepo[DynamicRuleStatRepository]:::repo
    end
    EVAL --> RECORepo
    RULESVC --> DRRepo
    STAT --> DRStatRepo
    subgraph DB
      RDB[(rules-db)]:::db
      RCO[(reco-db)]:::db
    end
    DRRepo --> RDB
    DRStatRepo --> RDB
    RECORepo --> RCO
    classDef actor fill:#f5f5f5,stroke:#333;
    classDef entry fill:#e3f2fd,stroke:#1976d2;
    classDef service fill:#fff8e1,stroke:#f9a825;
    classDef repo fill:#f3e5f5,stroke:#6a1b9a;
    classDef db fill:#ede7f6,stroke:#5e35b1;
```
## ‚öôÔ∏è –î–∏–∞–≥—Ä–∞–º–º–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
```mermaid
flowchart TD
    A([–°—Ç–∞—Ä—Ç]) --> B{–ò—Å—Ç–æ—á–Ω–∏–∫ –∑–∞–ø—Ä–æ—Å–∞?}
    B -->|REST| C[–ü–æ–ª—É—á–∏—Ç—å userId]
    B -->|Telegram| D[–ù–∞–π—Ç–∏ UUID –ø–æ –§–ò–û]
    D -->|–ù–∞–π–¥–µ–Ω| C
    D -->|–ù–µ –Ω–∞–π–¥–µ–Ω| E[–û—Ç–≤–µ—Ç: –Ω–µ –Ω–∞–π–¥–µ–Ω] --> END
    C --> F[–í—ã–ø–æ–ª–Ω–∏—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞]
    F --> G[–í—ã–ø–æ–ª–Ω–∏—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞]
    G --> H[–°–æ–±—Ä–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏]
    H --> I[–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é]
    I --> END([–ö–æ–Ω–µ—Ü])
```
## üß† –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- **RecommendationsController** ‚Äî –æ—Ç–¥–∞—ë—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.
- **DynamicRecommendationsController** ‚Äî —Ç–æ–ª—å–∫–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ.
- **RuleController** ‚Äî CRUD –ø—Ä–∞–≤–∏–ª.
- **ManagementController** ‚Äî –æ—á–∏—Å—Ç–∫–∞ –∫–µ—à–µ–π.
- **RuleService / RuleStatService / DynamicRuleEvaluator** ‚Äî –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞.
- **DynamicRuleRepository / RecommendationsRepository** ‚Äî –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º.
